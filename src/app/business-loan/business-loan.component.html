<div class="business-loan-container">
  <div class="header">
    <h1>Business Loan Pages</h1>
    <p>Manage pages and their configurations for the business loan section.</p>
    <button class="add-page-btn" (click)="addNewPage()">
      <span class="icon">+</span>
      Add New Page
    </button>
  </div>

  <div class="pages-grid">
    @for (page of pages(); track page.id) {
      <div 
        class="page-card"
        draggable="true"
        (dragstart)="onDragStart($event, page)"
        (dragover)="onDragOver($event)"
        (dragenter)="onDragEnter($event)"
        (dragleave)="onDragLeave($event)"
        (drop)="onDrop($event, page)"
        (dragend)="onDragEnd($event)"
        [class.dragging]="draggedPage()?.id === page.id"
      >
        <div class="page-header">
          <h3>{{ page.title }}</h3>
          <div class="page-actions">
            <button class="action-btn edit" (click)="editPage(page)" title="Edit page">
              <span class="icon">✏️</span>
            </button>
            <button class="action-btn delete" (click)="deletePage(page)" title="Delete page">
              <span class="icon">🗑️</span>
            </button>
          </div>
        </div>
        <div class="page-content">
          <p class="description">{{ page.description }}</p>
          <div class="page-meta">
            <span class="posthog-event">
              <strong>PostHog Event:</strong> {{ page.posthogEvent }}
            </span>
            <span class="created-date">
              Created: {{ page.createdAt | date:'shortDate' }}
            </span>
          </div>
        </div>
      </div>
    }
  </div>

  <ib-page-dialog
    [dialogType]="dialogType()"
    [selectedPage]="selectedPage()"
    [dialogForm]="dialogForm()"
    [isOpen]="showDialog()"
    (close)="closeDialog()"
    (save)="onDialogSave($event)"
    (delete)="onDialogDelete()"
    (formChange)="dialogForm.set($event)"
  />
</div> 