<div class="stats-container">
  <div class="header">
    <div class="header-content">
      <h1>Business Loan Statistics</h1>
      <p>Track and analyze business loan applications and their status.</p>
    </div>
  </div>

  <ib-summary-cards
    [totalAmount]="formatCurrency(getTotalAmount(), 'USD')"
    [totalCount]="loans().length"
    [approvedAmount]="formatCurrency(getApprovedAmount(), 'USD')"
    [approvedCount]="approvedCompletedCount()"
    [pendingAmount]="formatCurrency(getPendingAmount(), 'USD')"
    [pendingCount]="pendingCount()">
  </ib-summary-cards>

  <ib-loan-filters
    [isExpanded]="isFiltersExpanded()"
    [searchTerm]="searchTerm()"
    [statusFilter]="statusFilter()"
    [currencyFilter]="currencyFilter()"
    [minAmount]="minAmount()"
    [maxAmount]="maxAmount()"
    (toggleFilters)="toggleFilters()"
    (searchChange)="onSearchChange($event)"
    (statusFilterChange)="onStatusFilterChange($event)"
    (currencyFilterChange)="onCurrencyFilterChange($event)"
    (minAmountChange)="onMinAmountChange($event)"
    (maxAmountChange)="onMaxAmountChange($event)">
  </ib-loan-filters>

  <ib-loans-table
    [loans]="paginatedLoans()"
    [sortColumn]="sortColumn()"
    [sortDirection]="sortDirection()"
    (sort)="sortByColumn($event)"
    (loanClick)="openLoanDetails($event)">
  </ib-loans-table>

  <!-- Pagination -->
  @if (totalPages() > 1) {
    <div class="pagination">
      <button 
        [disabled]="currentPage() === 1"
        (click)="previousPage()"
        class="page-btn"
      >
        Previous
      </button>
      <span class="page-info">Page {{ currentPage() }} of {{ totalPages() }}</span>
      <button 
        [disabled]="currentPage() === totalPages()"
        (click)="nextPage()"
        class="page-btn"
      >
        Next
      </button>
    </div>
  }
  <ib-loan-detail-dialog
    [loan]="selectedLoan()"
    [isOpen]="isDialogOpen()"
    (closeDialog)="closeLoanDetails()"
  ></ib-loan-detail-dialog>
</div> 