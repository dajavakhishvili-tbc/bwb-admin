@if (isOpen()) {
  <div class="dialog-overlay" (click)="onClose()">
    <div class="dialog-content" (click)="$event.stopPropagation()">
      <div class="dialog-header">
        <h2>{{ isEditing() ? 'Edit Text' : 'Add New Text' }}</h2>
        <button class="close-btn" (click)="onClose()">&times;</button>
      </div>
      
      <div class="dialog-body">
        <div class="form-group">
          <label for="english-text">English Text:</label>
          <textarea 
            id="english-text"
            [value]="form().english"
            (input)="onEnglishTextInput($event)"
            placeholder="Enter English text..."
            rows="3"
          ></textarea>
        </div>
        
        <div class="form-group">
          <label for="georgian-text">Georgian Text:</label>
          <textarea 
            id="georgian-text"
            [value]="form().georgian"
            (input)="onGeorgianTextInput($event)"
            placeholder="შეიყვანეთ ქართული ტექსტი..."
            rows="3"
          ></textarea>
        </div>
        
        <div class="form-group">
          <label for="text-key">Key:</label>
          <input 
            type="text"
            id="text-key"
            [value]="form().key"
            (input)="onKeyInput($event)"
            placeholder="Enter key (e.g., main.header)"
            [class.form-input]="true"
            [class.invalid]="form().key.trim() && !isKeyValid()"
            pattern="^[a-z0-9]+(\.[a-z0-9]+)*$"
            title="Key must contain only lowercase letters, numbers, and dots. No spaces allowed."
          />
          @if (form().key.trim() && !isKeyValid()) {
            <div class="validation-error">
              Key must contain only lowercase letters, numbers, and dots (e.g., main.header)
            </div>
          }
        </div>
        
        <div class="form-group">
          <label>Channels:</label>
          <div class="channel-selector">
            <div 
              class="channel-select-chip" 
              [class.selected]="isChannelSelected('BWB')"
              [class.channel-bwb]="true"
              (click)="toggleChannel('BWB')"
            >
              BWB
            </div>
            <div 
              class="channel-select-chip" 
              [class.selected]="isChannelSelected('BMB')"
              [class.channel-bmb]="true"
              (click)="toggleChannel('BMB')"
            >
              BMB
            </div>
          </div>
        </div>
        
        <div class="form-group">
          <label>Labels (optional):</label>
          <div class="labels-input-container">
            <div class="labels-display">
              @for (label of form().labels; track label) {
                <span class="label-chip editable">
                  {{ label }}
                  <button type="button" class="remove-label" (click)="removeLabel(label)">&times;</button>
                </span>
              }
            </div>
            <input 
              type="text"
              [value]="labelInput()"
              (input)="onLabelInput($event)"
              (keypress)="onLabelKeyPress($event)"
              (blur)="addLabel()"
              placeholder="Type label and press Enter or comma..."
              class="label-input"
            />
          </div>
        </div>
      </div>
      
      <div class="dialog-footer">
        <button class="cancel-btn" (click)="onClose()">Cancel</button>
        <button 
          class="submit-btn" 
          [class.disabled]="!isFormValid()"
          [disabled]="!isFormValid()"
          (click)="onSubmit()"
        >
          {{ isEditing() ? 'Update Text' : 'Add Text' }}
        </button>
      </div>
    </div>
  </div>
}