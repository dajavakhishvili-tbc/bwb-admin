@if (isOpen()) {
  <div class="dialog-overlay" (click)="onClose()">
    <div class="dialog-content" (click)="$event.stopPropagation()">
      <div class="dialog-header">
        <h2 class="dialog-title">{{ getDialogTitle() }}</h2>
        <button class="close-btn" (click)="onClose()" title="Close dialog">
          <span class="close-icon">‚úï</span>
        </button>
      </div>

      <div class="dialog-body">
        <form class="offer-form" (ngSubmit)="onSave()">
          <div class="form-group">
            <label for="title" class="form-label">Title *</label>
            <input
              type="text"
              id="title"
              name="title"
              class="form-input"
              [value]="form().title"
              (input)="onTitleChange($event)"
              placeholder="Enter offer title"
              required
            />
          </div>

          <div class="form-group">
            <label for="description" class="form-label">Description *</label>
            <textarea
              id="description"
              name="description"
              class="form-textarea"
              [value]="form().description"
              (input)="onDescriptionChange($event)"
              placeholder="Enter offer description"
              rows="4"
              required
            ></textarea>
          </div>

          <div class="form-group">
            <label for="type" class="form-label">Type *</label>
            <select
              id="type"
              name="type"
              class="form-select"
              [value]="form().type"
              (change)="onTypeChange($event)"
              required
            >
              <option value="dashboard">Dashboard</option>
              <option value="offers">Offers</option>
              <option value="whats-new">What's New</option>
            </select>
            <div class="field-help">
              <span class="help-text">Select the section where this content will appear</span>
            </div>
          </div>

          <div class="form-group">
            <label class="form-label">Device *</label>
            <div class="device-selector">
              <div 
                class="device-select-chip" 
                [class.selected]="isDeviceSelected('web')"
                [class.device-web]="true"
                (click)="onDeviceChange('web')"
              >
                üåê Web
              </div>
              <div 
                class="device-select-chip" 
                [class.selected]="isDeviceSelected('mobile')"
                [class.device-mobile]="true"
                (click)="onDeviceChange('mobile')"
              >
                üì± Mobile
              </div>
            </div>
            <div class="field-help">
              <span class="help-text">Select the device type for this offer</span>
            </div>
          </div>

          <div class="form-group">
            <label class="form-label">Image Upload *</label>
            <div class="file-upload-container">
              @if (!selectedFile() && !imagePreview()) {
                <div class="file-upload-area">
                  <input
                    type="file"
                    name="imageFile"
                    class="file-input"
                    accept="image/*"
                    (change)="onFileSelected($event)"
                    required
                  />
                  <div class="upload-placeholder">
                    <span class="upload-icon">üìÅ</span>
                    <span class="upload-text">Click to upload image</span>
                    <span class="upload-hint">or drag and drop</span>
                  </div>
                </div>
              } @else {
                <div class="image-preview-container">
                  <img [src]="imagePreview()" alt="Preview" class="preview-image" />
                  <button type="button" class="remove-image-btn" (click)="removeSelectedFile()">
                    <span class="remove-icon">‚úï</span>
                  </button>
                </div>
              }
            </div>
            <div class="upload-info">
              <span class="file-types">Supported: JPG, PNG, GIF (max 5MB)</span>
            </div>
          </div>

          <div class="form-group">
            <label class="form-label">Date Range (Optional)</label>
            <div class="date-range-container">
              <div class="date-input-group">
                <label for="startDate" class="date-label">Start Date</label>
                <input
                  type="date"
                  id="startDate"
                  name="startDate"
                  class="form-input date-input"
                  [value]="getDateValue(form().startDate)"
                  (change)="onStartDateChange($event)"
                />
              </div>
              <div class="date-input-group">
                <label for="endDate" class="date-label">End Date</label>
                <input
                  type="date"
                  id="endDate"
                  name="endDate"
                  class="form-input date-input"
                  [value]="getDateValue(form().endDate)"
                  [min]="getTodayDate()"
                  (change)="onEndDateChange($event)"
                />
              </div>
            </div>
            @if (dateValidationError()) {
              <div class="field-error">
                <span class="error-text">{{ dateValidationError() }}</span>
              </div>
            }
            <div class="field-help">
              <span class="help-text">Select the date range when this offer will be active</span>
            </div>
          </div>

          <div class="form-group">
            <label for="statsIframe" class="form-label">Statistics Iframe URL (Optional)</label>
            <input
              type="url"
              id="statsIframe"
              name="statsIframe"
              class="form-input"
              [value]="form().statsIframe || ''"
              (input)="onStatsIframeChange($event)"
              placeholder="Enter iframe URL for statistics dashboard"
            />
            <div class="field-help">
              <span class="help-text">Paste the iframe URL to enable statistics tracking for this offer</span>
            </div>
          </div>

          <div class="form-actions">
            <button type="button" class="btn btn-secondary" (click)="onClose()">
              Cancel
            </button>
            <button 
              type="submit" 
              class="btn btn-primary" 
              [disabled]="!isFormValid()">
              {{ getSaveButtonText() }}
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
} 