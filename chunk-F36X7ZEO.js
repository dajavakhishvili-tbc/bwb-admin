import{d as Q,e as W,g as X,i as I}from"./chunk-FS4JG4DK.js";import{b as Y,i as J}from"./chunk-IKA6NDZH.js";import"./chunk-HYPGHTY2.js";import{Ca as F,Da as H,Db as q,Fa as m,Fb as s,Gb as D,Hb as V,Pa as y,T as E,Wa as h,Y as c,Z as f,a as O,b as S,fb as C,ga as p,gb as v,ia as R,ib as $,jb as B,kb as x,lb as o,mb as d,nb as G,ob as g,pb as _,qb as T,rb as b,sb as k,vb as u,wb as M,xb as a}from"./chunk-BPFOLRV5.js";function ee(r,t){if(r&1){let e=b();g(0,"button",14),M("click",function(){c(e);let n=a();return f(n.onShowStats())}),g(1,"span",15),s(2,"\u{1F4CA}"),_()()}}var U=class r{offer;edit=new h;delete=new h;showStats=new h;isStatsOpen=p(!1);onEdit(){this.edit.emit(this.offer)}onDelete(){this.delete.emit(this.offer.id)}onShowStats(){this.showStats.emit(this.offer)}formatDate(t){return new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=y({type:r,selectors:[["ib-offer-card"]],inputs:{offer:"offer"},outputs:{edit:"edit",delete:"delete",showStats:"showStats"},decls:21,vars:7,consts:[[1,"offer-card"],[1,"card-image"],[1,"image",3,"src","alt"],["title","View statistics",1,"stats-btn"],[1,"image-overlay"],["title","Edit offer",1,"edit-btn",3,"click"],[1,"btn-icon"],["title","Delete offer",1,"delete-btn",3,"click"],[1,"card-content"],[1,"card-title"],[1,"card-description"],[1,"card-footer"],[1,"card-date"],[1,"card-author"],["title","View statistics",1,"stats-btn",3,"click"],[1,"stats-icon"]],template:function(e,i){e&1&&(g(0,"div",0)(1,"div",1),T(2,"img",2),C(3,ee,3,0,"button",3),g(4,"div",4)(5,"button",5),M("click",function(){return i.onEdit()}),g(6,"span",6),s(7,"\u270F\uFE0F"),_()(),g(8,"button",7),M("click",function(){return i.onDelete()}),g(9,"span",6),s(10,"\u{1F5D1}\uFE0F"),_()()()(),g(11,"div",8)(12,"h3",9),s(13),_(),g(14,"p",10),s(15),_(),g(16,"div",11)(17,"span",12),s(18),_(),g(19,"span",13),s(20),_()()()()),e&2&&(m(2),k("src",i.offer.imageUrl,F)("alt",i.offer.title),m(),v(i.offer.statsIframe?3:-1),m(10),D(i.offer.title),m(2),D(i.offer.description),m(3),V("Created: ",i.formatDate(i.offer.createdAt)),m(2),D(i.offer.author))},styles:[".offer-card[_ngcontent-%COMP%]{background:var(--card-bg, #ffffff);border-radius:21.6px;box-shadow:0 4px 6px -1px #0000001a,0 2px 4px -1px #0000000f;overflow:hidden;transition:all .3s ease;border:1px solid var(--card-border, #e5e7eb);height:310px;display:flex;flex-direction:column}.offer-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 10px 25px -3px #0000001a,0 4px 6px -2px #0000000d}.card-image[_ngcontent-%COMP%]{position:relative;height:150px;overflow:hidden;background:var(--image-bg, #f3f4f6);flex-shrink:0}.card-image[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;transition:transform .3s ease}.card-image[_ngcontent-%COMP%]   .stats-btn[_ngcontent-%COMP%]{position:absolute;top:.75rem;left:.75rem;background:#dddddd45;border:none;border-radius:50%;width:36px;height:36px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .2s ease;z-index:2;box-shadow:0 2px 8px #00000026}.card-image[_ngcontent-%COMP%]   .stats-btn[_ngcontent-%COMP%]:hover{background:#fff;transform:scale(1.1);box-shadow:0 4px 12px #0003}.card-image[_ngcontent-%COMP%]   .stats-btn[_ngcontent-%COMP%]   .stats-icon[_ngcontent-%COMP%]{font-size:1rem}.card-image[_ngcontent-%COMP%]   .image-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background:#00000080;display:flex;align-items:center;justify-content:center;gap:.5rem;opacity:0;transition:opacity .3s ease}.card-image[_ngcontent-%COMP%]:hover   .image[_ngcontent-%COMP%]{transform:scale(1.05)}.card-image[_ngcontent-%COMP%]:hover   .image-overlay[_ngcontent-%COMP%]{opacity:1}.edit-btn[_ngcontent-%COMP%], .delete-btn[_ngcontent-%COMP%]{background:#ffffffe6;border:none;border-radius:50%;width:40px;height:40px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .2s ease}.edit-btn[_ngcontent-%COMP%]:hover, .delete-btn[_ngcontent-%COMP%]:hover{background:#fff;transform:scale(1.1)}.edit-btn[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%], .delete-btn[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]{font-size:1rem}.delete-btn[_ngcontent-%COMP%]:hover{background:#fee2e2;color:#dc2626}.card-content[_ngcontent-%COMP%]{padding:1.5rem;flex:1;display:flex;flex-direction:column}.card-title[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:600;color:var(--text-primary, #111827);margin:0 0 .75rem;line-height:1.4;display:-webkit-box;-webkit-line-clamp:2;line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}.card-description[_ngcontent-%COMP%]{color:var(--text-secondary, #6b7280);font-size:.875rem;line-height:1.5;margin:0 0 1rem;display:-webkit-box;-webkit-line-clamp:3;line-clamp:3;-webkit-box-orient:vertical;overflow:hidden;flex:1}.card-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding-top:.5rem;border-top:1px solid var(--border-color, #e5e7eb);margin-top:auto;flex-shrink:0}.card-date[_ngcontent-%COMP%]{font-size:.75rem;color:var(--text-tertiary, #9ca3af);font-weight:500}.card-author[_ngcontent-%COMP%]{font-size:.75rem;color:var(--text-secondary, #6b7280);font-weight:500;background:var(--bg-secondary, #f3f4f6);padding:.25rem .5rem;border-radius:.375rem;border:1px solid var(--border-color, #e5e7eb)}@media (prefers-color-scheme: dark){.offer-card[_ngcontent-%COMP%]{--card-bg: #1f2937;--card-border: #374151;--text-primary: #f9fafb;--text-secondary: #d1d5db;--text-tertiary: #9ca3af;--image-bg: #111827}}"],changeDetection:0})};function te(r,t){if(r&1){let e=b();o(0,"div",20)(1,"input",27),u("change",function(n){c(e);let l=a(2);return f(l.onFileSelected(n))}),d(),o(2,"div",28)(3,"span",29),s(4,"\u{1F4C1}"),d(),o(5,"span",30),s(6,"Click to upload image"),d(),o(7,"span",31),s(8,"or drag and drop"),d()()()}}function ne(r,t){if(r&1){let e=b();o(0,"div",21),G(1,"img",32),o(2,"button",33),u("click",function(){c(e);let n=a(2);return f(n.removeSelectedFile())}),o(3,"span",34),s(4,"\u2715"),d()()()}if(r&2){let e=a(2);m(),x("src",e.imagePreview(),F)}}function ie(r,t){if(r&1){let e=b();o(0,"div",1),u("click",function(){c(e);let n=a();return f(n.onClose())}),o(1,"div",2),u("click",function(n){return c(e),f(n.stopPropagation())}),o(2,"div",3)(3,"h2",4),s(4),d(),o(5,"button",5),u("click",function(){c(e);let n=a();return f(n.onClose())}),o(6,"span",6),s(7,"\u2715"),d()()(),o(8,"div",7)(9,"form",8),u("ngSubmit",function(){c(e);let n=a();return f(n.onSave())}),o(10,"div",9)(11,"label",10),s(12,"Title *"),d(),o(13,"input",11),u("input",function(n){c(e);let l=a();return f(l.onTitleChange(n))}),d()(),o(14,"div",9)(15,"label",12),s(16,"Description *"),d(),o(17,"textarea",13),u("input",function(n){c(e);let l=a();return f(l.onDescriptionChange(n))}),d()(),o(18,"div",9)(19,"label",14),s(20,"Statistics Iframe URL (Optional)"),d(),o(21,"input",15),u("input",function(n){c(e);let l=a();return f(l.onStatsIframeChange(n))}),d(),o(22,"div",16)(23,"span",17),s(24,"Paste the iframe URL to enable statistics tracking for this offer"),d()()(),o(25,"div",9)(26,"label",18),s(27,"Image Upload *"),d(),o(28,"div",19),C(29,te,9,0,"div",20)(30,ne,5,1,"div",21),d(),o(31,"div",22)(32,"span",23),s(33,"Supported: JPG, PNG, GIF (max 5MB)"),d()()(),o(34,"div",24)(35,"button",25),u("click",function(){c(e);let n=a();return f(n.onClose())}),s(36," Cancel "),d(),o(37,"button",26),s(38),d()()()()()()}if(r&2){let e=a();m(4),D(e.getDialogTitle()),m(9),x("value",e.form().title),m(4),x("value",e.form().description),m(4),x("value",e.form().statsIframe||""),m(8),v(!e.selectedFile()&&!e.imagePreview()?29:30),m(8),x("disabled",!e.isFormValid()),m(),V(" ",e.getSaveButtonText()," ")}}var z=class r{isOpen=!1;dialogType="add";dialogForm={title:"",description:"",imageUrl:"",statsIframe:""};close=new h;save=new h;form=p({title:"",description:"",imageUrl:"",statsIframe:""});isFormValid=p(!1);selectedFile=p(null);imagePreview=p("");constructor(){this.updateFormValidation()}ngOnChanges(){this.isOpen&&(this.form.set(O({},this.dialogForm)),this.selectedFile.set(null),this.imagePreview.set(this.dialogForm.imageUrl||""),this.updateFormValidation())}onFormChange(){this.updateFormValidation()}updateFormValidation(){let t=this.form(),e=t.title.trim().length>0&&t.description.trim().length>0&&(t.imageUrl.trim().length>0||this.selectedFile()!==null);this.isFormValid.set(e)}onClose(){this.close.emit()}onSave(){if(this.isFormValid()){let t=O({},this.form());if(this.selectedFile()){let e=this.selectedFile(),i=new FileReader;i.onload=n=>{t.imageUrl=n.target?.result,this.save.emit(t)},i.readAsDataURL(e)}else this.save.emit(t)}}onFileSelected(t){let i=t.target.files?.[0];if(i){if(!i.type.startsWith("image/")){alert("Please select an image file.");return}if(i.size>5*1024*1024){alert("File size must be less than 5MB.");return}this.selectedFile.set(i);let n=new FileReader;n.onload=l=>{this.imagePreview.set(l.target?.result)},n.readAsDataURL(i),this.updateFormValidation()}}onTitleChange(t){let e=t.target;this.form.set(S(O({},this.form()),{title:e.value})),this.updateFormValidation()}onDescriptionChange(t){let e=t.target;this.form.set(S(O({},this.form()),{description:e.value})),this.updateFormValidation()}onStatsIframeChange(t){let e=t.target;this.form.set(S(O({},this.form()),{statsIframe:e.value})),this.updateFormValidation()}removeSelectedFile(){this.selectedFile.set(null),this.imagePreview.set(""),this.updateFormValidation()}getDialogTitle(){return this.dialogType==="add"?"Add New Offer":"Edit Offer"}getSaveButtonText(){return this.dialogType==="add"?"Create Offer":"Update Offer"}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=y({type:r,selectors:[["ib-offer-dialog"]],inputs:{isOpen:"isOpen",dialogType:"dialogType",dialogForm:"dialogForm"},outputs:{close:"close",save:"save"},features:[R],decls:1,vars:1,consts:[[1,"dialog-overlay"],[1,"dialog-overlay",3,"click"],[1,"dialog-content",3,"click"],[1,"dialog-header"],[1,"dialog-title"],["title","Close dialog",1,"close-btn",3,"click"],[1,"close-icon"],[1,"dialog-body"],[1,"offer-form",3,"ngSubmit"],[1,"form-group"],["for","title",1,"form-label"],["type","text","id","title","name","title","placeholder","Enter offer title","required","",1,"form-input",3,"input","value"],["for","description",1,"form-label"],["id","description","name","description","placeholder","Enter offer description","rows","4","required","",1,"form-textarea",3,"input","value"],["for","statsIframe",1,"form-label"],["type","url","id","statsIframe","name","statsIframe","placeholder","Enter iframe URL for statistics dashboard",1,"form-input",3,"input","value"],[1,"field-help"],[1,"help-text"],["for","imageFile",1,"form-label"],[1,"file-upload-container"],[1,"file-upload-area"],[1,"image-preview-container"],[1,"upload-info"],[1,"file-types"],[1,"form-actions"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled"],["type","file","id","imageFile","name","imageFile","accept","image/*","required","",1,"file-input",3,"change"],[1,"upload-placeholder"],[1,"upload-icon"],[1,"upload-text"],[1,"upload-hint"],["alt","Preview",1,"preview-image",3,"src"],["type","button",1,"remove-image-btn",3,"click"],[1,"remove-icon"]],template:function(e,i){e&1&&C(0,ie,39,7,"div",0),e&2&&v(i.isOpen?0:-1)},dependencies:[I,X,Q,W],styles:[".dialog-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000;padding:1rem}.dialog-content[_ngcontent-%COMP%]{background:var(--dialog-bg, #ffffff);border-radius:.75rem;box-shadow:0 20px 25px -5px #0000001a,0 10px 10px -5px #0000000a;width:100%;max-width:500px;max-height:90vh;overflow-y:auto;animation:_ngcontent-%COMP%_dialogSlideIn .3s ease-out}@keyframes _ngcontent-%COMP%_dialogSlideIn{0%{opacity:0;transform:translateY(-20px) scale(.95)}to{opacity:1;transform:translateY(0) scale(1)}}.dialog-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1.5rem 1.5rem 1rem;border-bottom:1px solid var(--border-color, #e5e7eb)}.dialog-title[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600;color:var(--text-primary, #111827);margin:0}.close-btn[_ngcontent-%COMP%]{background:none;border:none;font-size:1.5rem;color:var(--text-secondary, #6b7280);cursor:pointer;padding:.5rem;border-radius:.375rem;transition:all .2s ease}.close-btn[_ngcontent-%COMP%]:hover{background:var(--hover-bg, #f3f4f6);color:var(--text-primary, #111827)}.dialog-body[_ngcontent-%COMP%]{padding:1.5rem}.offer-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.form-label[_ngcontent-%COMP%]{font-weight:500;color:var(--text-primary, #111827);font-size:.875rem}.form-input[_ngcontent-%COMP%], .form-textarea[_ngcontent-%COMP%]{padding:.75rem;border:1px solid var(--input-border, #d1d5db);border-radius:.5rem;font-size:.875rem;transition:all .2s ease;background:var(--input-bg, #ffffff);color:var(--text-primary, #111827)}.form-input[_ngcontent-%COMP%]:focus, .form-textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary-color, #3b82f6);box-shadow:0 0 0 3px #3b82f61a}.form-input[_ngcontent-%COMP%]::placeholder, .form-textarea[_ngcontent-%COMP%]::placeholder{color:var(--text-tertiary, #9ca3af)}.form-textarea[_ngcontent-%COMP%]{resize:vertical;min-height:100px}.file-upload-container[_ngcontent-%COMP%]{margin-top:.5rem}.file-upload-area[_ngcontent-%COMP%]{position:relative;border:2px dashed var(--input-border, #d1d5db);border-radius:.5rem;padding:2rem;text-align:center;background:var(--upload-bg, #f9fafb);transition:all .2s ease;cursor:pointer}.file-upload-area[_ngcontent-%COMP%]:hover{border-color:var(--primary-color, #3b82f6);background:var(--upload-hover-bg, #f0f9ff)}.file-upload-area[_ngcontent-%COMP%]   .file-input[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;opacity:0;cursor:pointer}.file-upload-area[_ngcontent-%COMP%]   .upload-placeholder[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:.5rem;pointer-events:none}.file-upload-area[_ngcontent-%COMP%]   .upload-icon[_ngcontent-%COMP%]{font-size:2rem;color:var(--text-secondary, #6b7280)}.file-upload-area[_ngcontent-%COMP%]   .upload-text[_ngcontent-%COMP%]{font-weight:500;color:var(--text-primary, #111827)}.file-upload-area[_ngcontent-%COMP%]   .upload-hint[_ngcontent-%COMP%]{font-size:.875rem;color:var(--text-secondary, #6b7280)}.image-preview-container[_ngcontent-%COMP%]{position:relative;border-radius:.5rem;overflow:hidden;border:1px solid var(--border-color, #e5e7eb);background:var(--upload-bg, #f9fafb)}.image-preview-container[_ngcontent-%COMP%]   .preview-image[_ngcontent-%COMP%]{width:100%;height:150px;object-fit:cover;display:block}.image-preview-container[_ngcontent-%COMP%]   .remove-image-btn[_ngcontent-%COMP%]{position:absolute;top:.5rem;right:.5rem;background:#000000b3;color:#fff;border:none;border-radius:50%;width:30px;height:30px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .2s ease}.image-preview-container[_ngcontent-%COMP%]   .remove-image-btn[_ngcontent-%COMP%]:hover{background:#000000e6;transform:scale(1.1)}.image-preview-container[_ngcontent-%COMP%]   .remove-image-btn[_ngcontent-%COMP%]   .remove-icon[_ngcontent-%COMP%]{font-size:.875rem}.upload-info[_ngcontent-%COMP%]{margin-top:.5rem}.upload-info[_ngcontent-%COMP%]   .file-types[_ngcontent-%COMP%]{font-size:.75rem;color:var(--text-tertiary, #9ca3af)}.field-help[_ngcontent-%COMP%]{margin-top:.5rem}.field-help[_ngcontent-%COMP%]   .help-text[_ngcontent-%COMP%]{font-size:.75rem;color:var(--text-tertiary, #9ca3af);font-style:italic}.form-actions[_ngcontent-%COMP%]{display:flex;gap:.75rem;justify-content:flex-end;padding-top:.5rem;border-top:1px solid var(--border-color, #e5e7eb)}.btn[_ngcontent-%COMP%]{padding:.75rem 1.5rem;border:none;border-radius:.5rem;font-weight:500;cursor:pointer;transition:all .2s ease;font-size:.875rem}.btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.btn-secondary[_ngcontent-%COMP%]{background:var(--secondary-bg, #f3f4f6);color:var(--text-primary, #111827)}.btn-secondary[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--secondary-hover, #e5e7eb)}.btn-primary[_ngcontent-%COMP%]{background:var(--primary-color, #3b82f6);color:#fff}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--primary-hover, #2563eb)}@media (prefers-color-scheme: dark){.dialog-content[_ngcontent-%COMP%]{--dialog-bg: #1f2937;--text-primary: #f9fafb;--text-secondary: #d1d5db;--text-tertiary: #9ca3af;--border-color: #374151;--input-border: #4b5563;--input-bg: #111827;--hover-bg: #374151;--secondary-bg: #374151;--secondary-hover: #4b5563;--primary-color: #60a5fa;--primary-hover: #3b82f6;--upload-bg: #111827;--upload-hover-bg: #1e293b}}@media (max-width: 640px){.dialog-overlay[_ngcontent-%COMP%]{padding:.5rem}.dialog-content[_ngcontent-%COMP%]{max-width:100%;margin:0}.dialog-header[_ngcontent-%COMP%]{padding:1rem 1rem 0}.dialog-body[_ngcontent-%COMP%]{padding:1rem}.form-actions[_ngcontent-%COMP%]{flex-direction:column}.btn[_ngcontent-%COMP%]{width:100%}}"],changeDetection:0})};function re(r,t){if(r&1&&T(0,"iframe",3),r&2){let e=a(2);k("src",e.getSafeIframeUrl(),H)}}function oe(r,t){r&1&&(g(0,"div",4)(1,"div",5),s(2,"\u{1F4CA}"),_(),g(3,"h4",6),s(4,"No Statistics Available"),_(),g(5,"p",7),s(6,"This offer doesn't have statistics tracking configured."),_()())}function ae(r,t){if(r&1){let e=b();g(0,"div",1),M("click",function(){c(e);let n=a();return f(n.closeSidebar())}),g(1,"div",2),M("click",function(n){return c(e),f(n.stopPropagation())}),C(2,re,1,1,"iframe",3)(3,oe,7,0,"div",4),_()()}if(r&2){let e=a();m(2),v(e.offer.statsIframe?2:3)}}var N=class r{offer;isOpen=p(!1);close=new h;sanitizer=E(Y);getSafeIframeUrl(){return this.offer?.statsIframe?this.sanitizer.bypassSecurityTrustResourceUrl(this.offer.statsIframe):null}closeSidebar(){this.close.emit()}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=y({type:r,selectors:[["ib-offer-stats-sidebar"]],inputs:{offer:"offer",isOpen:"isOpen"},outputs:{close:"close"},decls:1,vars:1,consts:[[1,"stats-overlay"],[1,"stats-overlay",3,"click"],[1,"stats-sidebar",3,"click"],["frameborder","0","width","600px","height","100%","allowfullscreen","",3,"src"],[1,"no-stats"],[1,"no-stats-icon"],[1,"no-stats-title"],[1,"no-stats-description"]],template:function(e,i){e&1&&C(0,ae,4,1,"div",0),e&2&&v(i.isOpen()?0:-1)},styles:[".stats-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;z-index:1000;display:flex;justify-content:flex-end;animation:_ngcontent-%COMP%_fadeIn .3s ease-out}.stats-sidebar[_ngcontent-%COMP%]{height:100vh;background:var(--card-bg, #ffffff);box-shadow:-4px 0 20px #00000026;display:flex;flex-direction:column;animation:_ngcontent-%COMP%_slideInRight .3s ease-out;overflow:hidden}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_slideInRight{0%{transform:translate(100%)}to{transform:translate(0)}}.sidebar-content[_ngcontent-%COMP%]{flex:1;padding:1.5rem;overflow-y:auto}.iframe-container[_ngcontent-%COMP%]{width:100%;height:calc(100vh - 60px);border-radius:.5rem;overflow:hidden;border:1px solid var(--border-color, #e5e7eb)}.no-stats[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:300px;text-align:center;padding:2rem;background:var(--bg-secondary, #f8f9fa);border-radius:.75rem;border:1px solid var(--border-color, #e5e7eb)}.no-stats-icon[_ngcontent-%COMP%]{font-size:3rem;margin-bottom:1rem;opacity:.5}.no-stats-title[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:600;color:var(--text-primary, #111827);margin:0 0 .5rem}.no-stats-description[_ngcontent-%COMP%]{font-size:.875rem;color:var(--text-secondary, #6b7280);margin:0;max-width:300px}@media (prefers-color-scheme: dark){.stats-sidebar[_ngcontent-%COMP%]{--card-bg: #1f2937;--bg-primary: #111827;--bg-secondary: #374151;--text-primary: #f9fafb;--text-secondary: #d1d5db;--text-tertiary: #9ca3af;--border-color: #4b5563}}"],changeDetection:0})};var se=(r,t)=>t.id;function de(r,t){if(r&1){let e=b();o(0,"div",6)(1,"div",10),s(2,"\u{1F381}"),d(),o(3,"h3",11),s(4,"No offers yet"),d(),o(5,"p",12),s(6,"Create your first offer to get started"),d(),o(7,"button",13),u("click",function(){c(e);let n=a();return f(n.openAddDialog())}),s(8," Create First Offer "),d()()}}function le(r,t){if(r&1){let e=b();o(0,"div",15),u("dragstart",function(n){let l=c(e).$implicit,P=a(2);return f(P.onDragStart(n,l))})("dragover",function(n){c(e);let l=a(2);return f(l.onDragOver(n))})("dragenter",function(n){c(e);let l=a(2);return f(l.onDragEnter(n))})("dragleave",function(n){c(e);let l=a(2);return f(l.onDragLeave(n))})("drop",function(n){let l=c(e).$implicit,P=a(2);return f(P.onDrop(n,l))})("dragend",function(n){c(e);let l=a(2);return f(l.onDragEnd(n))}),o(1,"ib-offer-card",16),u("edit",function(){let n=c(e).$implicit,l=a(2);return f(l.openEditDialog(n))})("delete",function(){let n=c(e).$implicit,l=a(2);return f(l.deleteOffer(n.id))})("showStats",function(n){c(e);let l=a(2);return f(l.showOfferStats(n))}),d()()}if(r&2){let e,i=t.$implicit,n=a(2);q("dragging",((e=n.draggedOffer())==null?null:e.id)===i.id),m(),x("offer",i)}}function ce(r,t){if(r&1&&(o(0,"div",7),$(1,le,2,3,"div",14,se),d()),r&2){let e=a();m(),B(e.offers())}}function fe(r,t){if(r&1){let e=b();o(0,"ib-offer-dialog",17),u("close",function(){c(e);let n=a();return f(n.closeDialog())})("save",function(n){c(e);let l=a();return f(l.saveOffer(n))}),d()}if(r&2){let e=a();x("isOpen",e.isDialogOpen())("dialogType",e.dialogType())("dialogForm",e.dialogForm())}}function me(r,t){if(r&1){let e=b();o(0,"ib-offer-stats-sidebar",18),u("close",function(){c(e);let n=a();return f(n.closeStatsSidebar())}),d()}if(r&2){let e=a();x("offer",e.selectedOfferForStats())("isOpen",e.isStatsSidebarOpen)}}var K=class r{offers=p([]);isDialogOpen=p(!1);dialogForm=p({title:"",description:"",imageUrl:"",statsIframe:""});dialogType=p("add");editingOfferId=p(null);draggedOffer=p(null);isStatsSidebarOpen=p(!1);selectedOfferForStats=p(null);authService=E(J);constructor(){this.offers.set([{id:1,title:"Special Discount",description:"Get 20% off on all products this week!",imageUrl:"https://picsum.photos/300/200?random=1",createdAt:new Date("2024-01-15"),author:"admin",statsIframe:"https://eu.posthog.com/shared/OvTht1LV7gDaz-Ca5X4UFimMF1qsfQ"},{id:2,title:"Free Shipping",description:"Free shipping on orders over $50",imageUrl:"https://picsum.photos/300/200?random=2",createdAt:new Date("2024-01-14"),author:"admin"},{id:3,title:"Limited Time Deal",description:"Flash sale! 50% off selected items for the next 24 hours only.",imageUrl:"https://picsum.photos/300/200?random=3",createdAt:new Date("2024-01-13"),author:"admin"},{id:4,title:"Buy One Get One",description:"Buy any item and get a second one absolutely free!",imageUrl:"https://picsum.photos/300/200?random=4",createdAt:new Date("2024-01-12"),author:"admin"},{id:5,title:"Student Discount",description:"Students get 15% off with valid student ID. Valid on all purchases.",imageUrl:"https://picsum.photos/300/200?random=5",createdAt:new Date("2024-01-11"),author:"admin"},{id:6,title:"Loyalty Rewards",description:"Earn points on every purchase and redeem for exclusive rewards.",imageUrl:"https://picsum.photos/300/200?random=6",createdAt:new Date("2024-01-10"),author:"admin"},{id:7,title:"Seasonal Clearance",description:"Up to 70% off on seasonal items. Limited quantities available.",imageUrl:"https://picsum.photos/300/200?random=7",createdAt:new Date("2024-01-09"),author:"admin"}])}openAddDialog(){this.dialogType.set("add"),this.dialogForm.set({title:"",description:"",imageUrl:"",statsIframe:""}),this.editingOfferId.set(null),this.isDialogOpen.set(!0)}openEditDialog(t){this.dialogType.set("edit"),this.dialogForm.set({title:t.title,description:t.description,imageUrl:t.imageUrl,statsIframe:t.statsIframe||""}),this.editingOfferId.set(t.id),this.isDialogOpen.set(!0)}closeDialog(){this.isDialogOpen.set(!1),this.editingOfferId.set(null)}saveOffer(t){if(this.dialogType()==="add"){let e=this.authService.getCurrentUser(),i={id:this.generateNextId(),title:t.title,description:t.description,imageUrl:t.imageUrl,createdAt:new Date,author:e?.username||"admin",statsIframe:t.statsIframe?.trim()||void 0};this.offers.set([i,...this.offers()])}else{let i=this.offers().map(n=>n.id===this.editingOfferId()?S(O({},n),{title:t.title,description:t.description,imageUrl:t.imageUrl,statsIframe:t.statsIframe?.trim()||void 0}):n);this.offers.set(i)}this.closeDialog()}deleteOffer(t){this.offers.set(this.offers().filter(e=>e.id!==t))}onDragStart(t,e){t.dataTransfer&&(t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("text/plain",e.id.toString()),this.draggedOffer.set(e))}onDragOver(t){t.preventDefault(),t.dataTransfer&&(t.dataTransfer.dropEffect="move")}onDragEnter(t){t.preventDefault(),t.currentTarget.classList.add("drag-over")}onDragLeave(t){t.currentTarget.classList.remove("drag-over")}onDrop(t,e){t.preventDefault(),t.currentTarget.classList.remove("drag-over");let n=this.draggedOffer();if(!n||n.id===e.id){this.draggedOffer.set(null);return}let l=this.offers(),P=l.findIndex(w=>w.id===n.id),j=l.findIndex(w=>w.id===e.id);if(P!==-1&&j!==-1){let w=[...l],[Z]=w.splice(P,1);w.splice(j,0,Z),this.offers.set(w)}this.draggedOffer.set(null)}onDragEnd(t){this.draggedOffer.set(null),t.currentTarget.classList.remove("drag-over")}showOfferStats(t){this.selectedOfferForStats.set(t),this.isStatsSidebarOpen.set(!0)}closeStatsSidebar(){this.isStatsSidebarOpen.set(!1),this.selectedOfferForStats.set(null)}generateNextId(){let t=this.offers();return t.length>0?Math.max(...t.map(e=>e.id))+1:1}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=y({type:r,selectors:[["ib-offers"]],decls:16,vars:3,consts:[[1,"offers-container"],[1,"header"],[1,"header-content"],[1,"add-offer-btn",3,"click"],[1,"icon"],[1,"offers-content"],[1,"empty-state"],[1,"offers-grid"],[3,"isOpen","dialogType","dialogForm"],[3,"offer","isOpen"],[1,"empty-icon"],[1,"empty-title"],[1,"empty-description"],[1,"empty-action-btn",3,"click"],["draggable","true",1,"offer-item",3,"dragging"],["draggable","true",1,"offer-item",3,"dragstart","dragover","dragenter","dragleave","drop","dragend"],[3,"edit","delete","showStats","offer"],[3,"close","save","isOpen","dialogType","dialogForm"],[3,"close","offer","isOpen"]],template:function(e,i){e&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),s(4,"Offers Management"),d(),o(5,"p"),s(6,"Manage offers and their configurations for the offers section."),d()(),o(7,"button",3),u("click",function(){return i.openAddDialog()}),o(8,"span",4),s(9,"+"),d(),s(10," Add content "),d()(),o(11,"div",5),C(12,de,9,0,"div",6)(13,ce,3,0,"div",7),d()(),C(14,fe,1,3,"ib-offer-dialog",8),C(15,me,1,2,"ib-offer-stats-sidebar",9)),e&2&&(m(12),v(i.offers().length===0?12:13),m(2),v(i.isDialogOpen()?14:-1),m(),v(i.isStatsSidebarOpen()&&i.selectedOfferForStats()?15:-1))},dependencies:[I,U,z,N],styles:[".offers-container[_ngcontent-%COMP%]{padding:2rem;margin:0 auto}.header[_ngcontent-%COMP%]{margin-bottom:2rem;display:flex;align-items:center;justify-content:space-between}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2.5rem;color:var(--text-primary);margin-bottom:.5rem;font-weight:600}.header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.1rem;color:var(--text-secondary);margin-bottom:1.5rem}.add-offer-btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.5rem;padding:.75rem 1.5rem;background:var(--button-primary);color:#fff;border:none;border-radius:8px;font-size:1rem;font-weight:500;cursor:pointer;transition:background .2s}.add-offer-btn[_ngcontent-%COMP%]:hover{background:var(--button-hover)}.add-offer-btn[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:700}.offers-content[_ngcontent-%COMP%]{min-height:400px}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:4rem 2rem;text-align:center;color:var(--text-secondary, #6b7280)}.empty-icon[_ngcontent-%COMP%]{font-size:4rem;margin-bottom:1rem}.empty-title[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600;margin:0 0 .5rem;color:var(--text-primary, #111827)}.empty-description[_ngcontent-%COMP%]{font-size:1rem;margin:0 0 2rem}.empty-action-btn[_ngcontent-%COMP%]{padding:.75rem 1.5rem;background:var(--primary-color, #3b82f6);color:#fff;border:none;border-radius:.5rem;font-weight:600;cursor:pointer;transition:all .2s ease}.empty-action-btn[_ngcontent-%COMP%]:hover{background:var(--primary-hover, #2563eb)}.offers-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(350px,1fr));gap:1.5rem;padding:1rem 0;align-items:start}.offer-item[_ngcontent-%COMP%]{cursor:grab;transition:transform .2s ease,box-shadow .2s ease}.offer-item[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.offer-item[_ngcontent-%COMP%]:active{cursor:grabbing}.offer-item.dragging[_ngcontent-%COMP%]{opacity:.5;transform:rotate(5deg);z-index:1000}.offer-item.drag-over[_ngcontent-%COMP%]{border:2px dashed var(--primary-color, #3b82f6);background:#3b82f60d}@media (max-width: 768px){.offers-container[_ngcontent-%COMP%]{padding:1rem}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2rem}.offers-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:1rem}}"],changeDetection:0})};export{K as OffersComponent};
